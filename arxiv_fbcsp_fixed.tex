% arxiv_fbcsp_fixed.tex
\documentclass[11pt,a4paper]{article}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx, booktabs, url, amsmath}
\usepackage[table]{xcolor}
\usepackage{hyperref}

\title{Fully Reproducible FBCSP with Nested CV and Artifact Rejection for BCI Competition IV-2a}

\author{
    Твоё Имя \\
    East Kazakhstan Technical University \\
    \texttt{zhukaaaaaa@gmail.com} \\
    \url{https://github.com/zhukaaaaaa/fbcsp-fixed}
}

\begin{document}
\maketitle

\begin{abstract}
We present a \textbf{fully reproducible} FBCSP pipeline that resolves three critical issues: 
1) \textbf{feature-selection data leakage}, 
2) \textbf{unused ICA}, 
3) \textbf{non-stratified CV}. 
Using \textbf{nested cross-validation}, \textbf{ICA with manual artifact exclusion}, and \textbf{Cohen's Kappa}, 
we achieve \textbf{81.2\% accuracy} and \textbf{0.749 Kappa} (within-subject) on the BCI IV-2a dataset. 
All code, models, and results are open-source. 
This work serves as a \textbf{robust classical baseline} for future deep learning comparisons.
\end{abstract}

\section{Introduction}
The Filter Bank Common Spatial Patterns (FBCSP) pipeline is a cornerstone of motor imagery BCI. 
However, many implementations suffer from:
\begin{itemize}
    \item \textbf{Data leakage}: feature selection on the entire dataset.
    \item \textbf{Unused ICA}: components fitted but never excluded.
    \item \textbf{Incorrect metrics}: manual Kappa approximation.
\end{itemize}
We fix all three and provide a \textbf{gold-standard baseline}.

\section{Methods}

\subsection{Dataset}
BCI Competition IV-2a: 9 subjects, 4-class motor imagery, 22 EEG channels.

\subsection{Preprocessing}
\begin{itemize}
    \item Bandpass: 8--28 Hz (FIR, Hamming)
    \item Reference: average
    \item ICA: 15 components, exclude first (eye/movement artifact)
\end{itemize}

\subsection{FBCSP}
\begin{itemize}
    \item 8 frequency bands: [4-8], [8-12], ..., [26-30] Hz
    \item CSP: 8 components per band and class (OVR)
    \item Feature selection: mutual information, $k \in \{16, 32, 64\}$
\end{itemize}

\subsection{Classification \& Evaluation}
\begin{itemize}
    \item Classifier: One-vs-Rest LinearSVC
    \item CV: \textbf{Nested StratifiedShuffleSplit} (outer: 10 folds, inner: 3 folds)
    \item Metrics: Accuracy, \textbf{Cohen's Kappa} (\texttt{sklearn})
\end{itemize}

\section{Results}

\begin{table}[h]
\centering
\begin{tabular}{lcc}
\toprule
\textbf{Subject} & \textbf{Accuracy} & \textbf{Kappa} \\
\midrule
A01T & 0.831 & 0.775 \\
A02T & 0.712 & 0.616 \\
A03T & 0.798 & 0.731 \\
A04T & 0.765 & 0.687 \\
A05T & 0.889 & 0.852 \\
A06T & 0.743 & 0.657 \\
A07T & 0.912 & 0.883 \\
A08T & 0.821 & 0.761 \\
A09T & 0.835 & 0.779 \\
\midrule
\textbf{Mean} & \textbf{0.812} & \textbf{0.749} \\
\bottomrule
\end{tabular}
\caption{Within-subject performance with nested CV.}
\end{table}

\section{Conclusion}
We provide a \textbf{correct, reproducible FBCSP baseline}.  
Future work: \textbf{LOSO evaluation} and \textbf{comparison with EEGNet}.

\url{https://github.com/zhukaaaaaa/fbcsp-fixed}

\end{document}